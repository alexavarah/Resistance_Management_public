---
title: "Plots"
author: "Alexa Varah"
date: "2023-02-20"
output: html_document
---

# 1. Set up
## 1.1. Load packages
```{r}
rm(list=ls())
library(tidyverse) # loads ggplot2
library(patchwork) # for panel plots
```

## 1.2. Load data

```{r}
## MAIN FIGURES
# Fig 2(a): Line graph - density
df_line_den <- read.csv("../output/data for line graph_density.csv", 
                        header = T) %>% 
  dplyr::mutate(
    scenario = factor(scenario, levels = c("BAU", "MIT", "CWW")),
    initDR3 = factor(initDR3,
                                  levels = c("LD-LR", "LD-HR", "HD-HR")))

# Fig 2(b): Line graph - gross profit
df_line_gp <- read.csv("../output/data for line graph_gross profit.csv", 
                       header = T) %>% 
  dplyr::mutate(
    scenario = factor(scenario, levels = c("BAU", "MIT", "CWW")),
    initDR3 = factor(initdenres_collapsed,
                                  levels = c("LD-LR", "LD-HR", "HD-HR"))) %>% 
  dplyr::select(-initdenres_collapsed)

# Fig 3: Stacked bar chart, costs and output
df_for_stack <- read.csv("../output/data for stacked bar plot.csv", 
                     header = T) %>% 
  dplyr::mutate(
    xval = factor(xval,
                  levels = c("BAU_LD-LR", "BAU_LD-HR", "BAU_HD-HR", 
                             "MIT_LD-LR", "MIT_LD-HR", "MIT_HD-HR"))
    )

levels(df_for_stack$xval)

# Fig 4(a): Scatter plot - worst case opportunity costs
df_wc_oc <- read.csv("../output/opp costs_worst case vs current.csv", 
                     header = T) %>% 
  dplyr::mutate(
    situation = factor(situation, levels = c("Current", "Worst case")),
    region = factor(region, levels = c("north", "central", "east")),
    soiltype = factor(soiltype, levels = c("heavy", "medium","light")),
    initdenres_collapsed = factor(initdenres_collapsed,
                                  levels = c("LD-LR", "LD-HR", "HD-HR")))

# Fig 4(b): Scatter plot - worst case productivity costs
df_wc_pc <- read.csv("../output/prod costs_worst case vs current.csv", 
                     header = T) %>% 
  dplyr::mutate(
    situation = factor(situation, levels = c("Current", "Worst case")),
    region = factor(region, levels = c("north", "central", "east")),
    soiltype = factor(soiltype, levels = c("heavy", "medium","light")),
    initdenres_collapsed = factor(initdenres_collapsed,
                                  levels = c("LD-LR", "LD-HR", "HD-HR")))


## SUPPLEMENTARY FIGURES

# Fig S4: Scatter plot - effect of init condition on weed density
density_3dr <- readRDS("../output/density_data_summarised_3dr.rds") %>% 
  dplyr::mutate(
    scenario = factor(scenario, levels = c("BAU", "MIT", "CWW")),
    initDR3 = factor(initDR3,
                                  levels = c("LD-LR", "LD-HR", "HD-HR")))

density_3dr_hd <- readRDS("../output/density_data_summarised_3dr_hd.rds") %>% 
  dplyr::mutate(
    scenario = factor(scenario, levels = c("BAU", "MIT", "CWW")),
    initDR3 = factor(initDR3,
                                  levels = c("LD-LR", "LD-HR", "HD-HR")))

# Fig S5(a): Scatter plot - gross profit
df_scatter_gp <- read.csv("../output/data for scatter plot_gross profit.csv", 
                          header = T) %>% 
  dplyr::mutate(
    scenario = factor(scenario, levels = c("BAU", "MIT", "CWW")),
    region = factor(region, levels = c("north", "central", "east")),
    soiltype = factor(soiltype, levels = c("heavy", "medium","light")),
    initdenres_collapsed = factor(initdenres_collapsed,
                                  levels = c("LD-LR", "LD-HR", "HD-HR")))

df_scatter_gp_hd <- read.csv("../output/data for scatter plot_gross profit_hd.csv", 
                          header = T) %>% 
  dplyr::mutate(
    scenario = factor(scenario, levels = c("BAU", "MIT", "CWW")),
    region = factor(region, levels = c("north", "central", "east")),
    soiltype = factor(soiltype, levels = c("heavy", "medium","light")),
    initdenres_collapsed = factor(initdenres_collapsed,
                                  levels = c("LD-LR", "LD-HR", "HD-HR")))


# Fig S5(b): Scatter plot - wheat yield
df_scatter_wwyld <- read.csv("../output/data for scatter plot_wheat yield.csv", 
                             header = T) %>% 
  dplyr::mutate(
    scenario = factor(scenario, levels = c("BAU", "MIT", "CWW")),
    region = factor(region, levels = c("north", "central", "east")),
    soiltype = factor(soiltype, levels = c("heavy", "medium","light")),
    initdenres_collapsed = factor(initdenres_collapsed,
                                  levels = c("LD-LR", "LD-HR", "HD-HR")))

df_scatter_wwyld_hd <- read.csv("../output/data for scatter plot_wheat yield_hd.csv", 
                             header = T) %>% 
  dplyr::mutate(
    scenario = factor(scenario, levels = c("BAU", "MIT", "CWW")),
    region = factor(region, levels = c("north", "central", "east")),
    soiltype = factor(soiltype, levels = c("heavy", "medium","light")),
    initdenres_collapsed = factor(initdenres_collapsed,
                                  levels = c("LD-LR", "LD-HR", "HD-HR")))

# Fig S6: Sensitivity analysis
# Fig S6(a) - opportunity costs - sensitivity analysis
gp_oc <- read.csv("../output/data for sensitivity analysis scatter_OC.csv", 
                     header = T) %>% 
  dplyr::mutate(
    scenario = factor(scenario, levels = c("BAU", "MIT", "CWW")),
    region = factor(region, levels = c("north", "central", "east")),
    soiltype = factor(soiltype, levels = c("heavy", "medium","light")),
    initdenres_collapsed = factor(initdenres_collapsed,
                                  levels = c("LD-LR", "LD-HR", "HD-HR")))

# Fig S6(b) - productivity costs - sensitivity analysis
ww_pc <- read.csv("../output/data for sensitivity analysis scatter_PC.csv", 
                     header = T) %>% 
  dplyr::mutate(
    scenario = factor(scenario, levels = c("BAU", "MIT", "CWW")),
    region = factor(region, levels = c("north", "central", "east")),
    soiltype = factor(soiltype, levels = c("heavy", "medium","light")),
    initdenres_collapsed = factor(initdenres_collapsed,
                                  levels = c("LD-LR", "LD-HR", "HD-HR")))
```


# ----
# MANUSCRIPT FIGURES ----

# 2. Figure 2: Line graphs of density and gross profit by year
## 2.1. Specify panel labels
```{r Fig2-panel-labels}
initDR3.labs <- c("(i) Low density,\n low resistance", "(ii) Low density,\n high resistance", "(iii) High density,\n high resistance")
names(initDR3.labs) <- c("LD-LR", "LD-HR", "HD-HR") # original
```

## 2.2. Figure 2(a): Weed density
```{r Fig2a-plot-weedden-linegraph-bw}
plot_wd <- ggplot(df_line_den, 
       aes(x = year, y = hvh, group = scenario, colour = scenario, linetype=scenario)) +
  facet_wrap(~initDR3, labeller = labeller(initDR3 = initDR3.labs)) +
  geom_ribbon(aes(ymin = hvh_95ci_l, ymax = hvh_95ci_u, fill = scenario), 
              alpha = 0.15, # controls transparency
              linetype = "blank" # gets rid of upper and lower lines
              ) +
  scale_fill_manual(
    name = "Scenario",
    values = c("black", # BAU, madison blue
               "grey61", # MIT, capri blue
               "grey40"  # CWW, royal blue
               )
    ) +
  geom_line() + 
  scale_linetype_manual(name = "Scenario", values=c(1,2,3)) +
  scale_color_manual(
    name = "Scenario",
    values = c("black", # BAU, madison blue
               "grey61", # MIT, capri blue
               "grey40"  # CWW, royal blue
               )
    ) +
  theme_classic() +
  labs(#x = "Year in rotation", 
       y = "Proportion of field with economically\ndamaging densities of black-grass") +
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    axis.title.x=element_blank(),
    axis.text.x=element_blank(), #remove x axis labels
    #axis.ticks.x=element_blank(), #remove x axis ticks
    plot.title = element_blank(), #remove x axis title
    axis.title=element_text(size=26),#18
    #axis.text.x=element_text(size=rel(2)),#1.7
    axis.text.y=element_text(size=rel(2.5)),#1.7
    legend.title=element_text(size=26),#18
    legend.text=element_text(size=26),#16
    strip.background = element_rect(color = "white",
                                    fill = "grey"),# colour of rectangle round region labels
    strip.text = element_text(size = 26)#16
    ) +
  theme(legend.position="none")

plot_wd
```

95% CIs show variation due to region and soil type.  

## 2.2. Figure 2(b): Gross profit
```{r Fig2b-plot-gp-linegraph-bw}
plot_gp <- ggplot(df_line_gp, aes(x = year, y = gp, group = scenario, 
                                       colour = scenario, linetype=scenario)) +
  facet_wrap(~initDR3, labeller = labeller(initDR3 = initDR3.labs)) +
  geom_ribbon(aes(ymin = gp_ci_l, ymax = gp_ci_u, fill = scenario), 
              alpha = 0.15, # controls transparency
              linetype = "blank" # gets rid of upper and lower lines
              ) +
  geom_line() + 
  scale_linetype_manual(name = "Scenario:", values=c(1,2,3)) +
  scale_fill_manual(
    name = "Scenario:",
    values = c("black", # BAU, madison blue
               "grey61", # MIT, capri blue
               "grey40"  # CWW, royal blue
               ) 
    ) +
  geom_line() +  
  scale_color_manual(
    name = "Scenario:",
    values = c("black", # BAU, madison blue
               "grey61", # MIT, capri blue
               "grey40"  # CWW, royal blue
               )
    ) +
  theme_classic() +
  labs(x = "Year in rotation", 
       y = "Annual gross profit (Â£/ha)") +
  theme(
    legend.position="bottom",
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    strip.text.x = element_blank(), #remove facet labels
    #plot.title = element_text(size=18, face="bold"),
    plot.title = element_blank(),
    axis.title=element_text(size=26),#18
    axis.text.x=element_text(size=rel(2.5)),#1.7
    axis.text.y=element_text(size=rel(2.5)),#1.7
    legend.title=element_text(size=26),#18
    legend.text=element_text(size=26),#16
    strip.background = element_rect(color = "white",
                                    fill = "grey"),# colour of rectangle round region labels
    strip.text = element_text(size = 26)#16
    )

plot_gp
```

95% CIs show variation due to region and soil type.  

## 2.4. Make panel plot, ncol = 1
```{r Fig2-arrange-panels}
fig2 <- (plot_wd + plot_gp) + 
  plot_layout(ncol=1) +
  plot_annotation(tag_levels = 'a', tag_prefix = '(',  tag_suffix = ')') & 
  theme(plot.tag = element_text(size = 24, face="bold"))
fig2
```



## 2.5. Save plot
```{r Fig2-save}
png("../figures/Figure 2.png",
    height = 15, width = 20, units = "in", res = 300)
print(fig2)
dev.off()
```


# 3. Figure 3: Stacked bar plot
## 3.1. Specify plot
```{r stacked-plot-bw, echo=TRUE, fig.keep='all'}
# **IMPORTANT!** 
# If not done earlier, specify order of factor levels here:
#df_for_stack <- df_for_stack %>% 
#  dplyr::mutate(
#    xval = factor(xval,
#                  levels = c("BAU_LD-LR", "BAU_LD-HR", "BAU_HD-HR", 
#                             "MIT_LD-LR", "MIT_LD-HR", "MIT_HD-HR"))
#    )

# Specify plot
fig3 <- ggplot(df_for_stack, aes(x=xval, y=amount, fill=cost)) +
  geom_bar(position="stack", stat="identity") +
  scale_fill_manual(
    name = "Cost \ncomponent",
    values = c('grey81', 'grey56', 'grey40'),# '#08306b',  #0E61DC
    labels = c('Herbicide', 'Operations', 'Other') # 'Lost yield', 
    ) +

  # 1. BAU LD-LR
  # output
  geom_point(aes(x = 1, y = 1416.308), 
             cex = 4, show.legend = FALSE) + # point #colour = "#020E20", 
  geom_segment(aes(x = 1, y = 1307.133, xend = 1, yend = 1525.483)) + # CIs
  # output with no BG
  geom_point(aes(x = 1.05, y = 1431.293), # point
             cex = 4, shape = 17, show.legend = FALSE) + 
  geom_segment(aes(x = 1.05, y = 1320.006, xend = 1.05, yend = 1542.580)) + # CIs
  # gross profit line
  geom_segment(aes(   x = 0.95,    y = 766.8389, 
                   xend = 0.95, yend = 1416.308, 
                   linetype = 'dotdash')) + # diff = gp 649.4691
  
  # 2. BAU LD-HR
  # output
  geom_point(aes(x = 2, y = 1378.1), 
             cex = 4, show.legend = FALSE) + # point #colour = "#020E20", 
  geom_segment(aes(   x = 2,    y = 1271.964, 
                   xend = 2, yend = 1484.184)) + # CIs
  # output with no BG
  geom_point(aes(x = 2.05, y = 1431.293), 
             cex = 4, shape = 17, show.legend = FALSE) + # point
  geom_segment(aes(x = 2.05, y = 1320.006, xend = 2.05, yend = 1542.580)) + # CIs
  # gross profit line
  geom_segment(aes(   x = 1.95,    y = 766.0656, 
                   xend = 1.95, yend = 1378.1, 
                   linetype = 'dashed')) +
  
  # 3. BAU HD-HR
  # output
  geom_point(aes(x = 3, y = 1349.2), 
             cex = 4, show.legend = FALSE) + # point #colour = "#020E20",
  geom_segment(aes(x = 3, y = 1244.473, xend = 3, yend = 1453.913)) + # CIs
  # output with no BG
  geom_point(aes(x = 3.05, y = 1431.293), 
             cex = 4, shape = 17, show.legend = FALSE) + 
  geom_segment(aes(x = 3.05, y = 1320.006, xend = 3.05, yend = 1542.580)) + # CIs #,colour = "#08306b"
  # gross profit line
  geom_segment(aes(   x = 2.95,    y = 767.4341, 
                   xend = 2.95, yend = 1349.2, 
                   linetype = 'dotted')) + 
  scale_linetype_identity() +  

  # 4. MIT LD-LR
  # output
  geom_point(aes(x = 4, y = 1447.7), cex = 4, show.legend = FALSE) + # point #colour = "#020E20", 
  geom_segment(aes(x = 4, y = 1349.828, xend = 4, yend = 1545.666)) + # CIs
  # output with no BG
  geom_point(aes(x = 4.05, y = 1452.119), cex = 4, shape = 17, show.legend = FALSE) + # point
  geom_segment(aes(x = 4.05, y = 1354.349, xend = 4.05, yend = 1549.890)) + # CIs
  # gross profit from BAU scenario
  geom_segment(aes(   x = 3.95,    y = 1447.7-649.4691, 
                   xend = 3.95, yend = 1447.7,
                   linetype = 'dotdash')) + # # diff = 649.4691
  
  # 5. MIT LD-HR
  # output
  geom_point(aes(x = 5, y = 1331.78), cex = 4, show.legend = FALSE) + # point #colour = "#020E20", 
  geom_segment(aes(x = 5, y = 1250.360, xend = 5, yend = 1413.200)) + # CIs
  # output with no BG
  geom_point(aes(x = 5.05, y = 1340.811), cex = 4, shape = 17, show.legend = FALSE) + # point
  geom_segment(aes(x = 5.05, y = 1259.247, xend = 5.05, yend = 1422.375)) + # CIs
  # gross profit from BAU scenario
  geom_segment(aes(   x = 4.95,    y = 719.7456, 
                   xend = 4.95, yend = 1331.78, 
                   linetype = 'dashed')) + # diff = 612.0344
  

  # 6. MIT HD-HR
  # output
  geom_point(aes(x = 6, y = 1190.729), cex = 4, show.legend = FALSE) + # point #colour = "#020E20", 
  geom_segment(aes(x = 6, y = 1108.905, xend = 6, yend = 1272.553)) + # CIs
  # output with no BG
  geom_point(aes(x = 6.05, y = 1218.576), cex = 4, shape = 17, show.legend = FALSE) + # point
  geom_segment(aes(x = 6.05, y = 1137.202, xend = 6.05, yend = 1299.950)) + # CIs
  # gross profit from BAU scenario
  geom_segment(aes(   x = 5.95,    y = 608.9631, 
                   xend = 5.95, yend = 1190.729, 
                   linetype = 'dotted')) +
  
  labs(x = "\n\nScenario and initial density-resistance state", 
       y = "Mean annual costs and output (Â£/ha)") +
  scale_x_discrete(labels=c('LD-LR', 'LD-HR', 'HD-HR',
                              'LD-LR', 'LD-HR', 'HD-HR')) +
  annotate("text", x=2, y=-230, label="BAU", size = 7) +
  annotate("text", x=5, y=-230, label="MIT", size = 7) +
  coord_cartesian(ylim=c(0,1600),clip="off") +
  theme_classic() +
  theme(axis.title=element_text(size=22),
        axis.text.x=element_text(size=rel(2)),#, 
        axis.text.y=element_text(size=rel(2)),
        legend.title=element_text(size=22),
        legend.text=element_text(size=20)
        ) 

fig3
```

Error bars show 95% CIs, which indicate variation across years in the rotation
Brackets and annotations on plot were added in MS Word.

## 3.2. Save plot
```{r}
png("../figures/Figure 3.png",
    height = 10, width = 17, units = "in", res = 300)
print(fig3)
dev.off()
```


# 4. Figure 4: Scatter plots of opportunity and productivity costs, for current and worst case conditions
## 4.1. Specify panel labels  
```{r Fig4-panel-labels}
region.labs <- c("Northern England", "Central England", "Eastern England") # new
names(region.labs) <- c("north", "central", "east") # original

soiltype.labs <- c("Heavy soil", "Medium soil", "Light soil") # new
names(soiltype.labs) <- c("heavy", "medium", "light") # original
```

## 4.2. Figure 4(a): Opportunity costs
### 4.2.1. Specify plot annotations
These will show the **numbers of spring crops and winter wheat crops** in each rotation.
```{r Fig4a-annotations}
anno_oc <- data.frame(
  x = c("HD-HR","HD-HR","HD-HR",
        "HD-HR","HD-HR","HD-HR",
        "HD-HR","HD-HR","HD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-LR","LD-LR","LD-LR",
        "LD-LR","LD-LR","LD-LR",
        "LD-LR","LD-LR","LD-LR"
        ),
  y = c(-550,-550,-550,
        -550,-550,-550,
        -550,-550,-550,
        -550,-550,-550,
        -550,-550,-550,
        -550,-550,-550,
        -550,-550,-550,
        -550,-550,-550,
        -550,-550,-550
        ),
  # numbers of spring / ww crops:
  lab = c("s3,w2", "s3,w2", "s3,w2", # north, HD-HR
          "s3,w2", "s3,w2", "s3,w2", # central, HD-HR
          "s4,w2", "s4,w2", "s4,w2", # east, HD-HR
          
          "s2,w2", "s2,w2", "s2,w2", # north, LD-HR
          "s2,w2", "s2,w2", "s2,w2", # central, LD-HR
          "s1,w3", "s1,w3", "s1,w3", # east, LD-HR
          
          "s1,w3", "s1,w3", "s1,w3", # north, LD-LR
          "s1,w3", "s1,w3", "s1,w3", # central, LD-LR
          "s0,w4", "s0,w4", "s0,w4"  # east, LD-LR
          ),
  region = c("north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east",
             "north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east",
             "north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east"
             ),
  soiltype = c("heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light"
               ),
  situation = c("Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current"
                )
           ) %>% 
  dplyr::mutate(
    region = factor(region,
                    levels = c("north", "central", "east")
                    ),
    soiltype = factor(soiltype,
                    levels = c("heavy", "medium", "light")
                    )
  )
```

### 4.2.2. Specify plot  
```{r Fig4a-plot}
fig4a <- ggplot(df_wc_oc, aes(initdenres_collapsed, oc*(-1), 
                    colour = situation, shape = situation)) + 
  facet_grid(region ~ soiltype,
             labeller = labeller(region = region.labs, 
                                 soiltype = soiltype.labs)
  ) +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  geom_hline(aes(yintercept = 0), color="grey") + #, linetype="dashed"
  labs(x = "Initial density and resistance", 
       y = "Mean annual opportunity cost, BAU-MIT (Â£/ha)") +
  # specify colours for 'situation':
  scale_color_manual(name = "Situation",
                     values = c("grey61", # current, (capri blue #00C2F9) (blue #1A85FF)
                                "#000000" # worst case, (magenta #EE3377) (pink #D41159)
                                )
                     ) + 
  scale_shape_manual(name = "Situation",
                     values=c(15, 16)) + # current 15 square; worst 16 circle
  theme(strip.placement = 'outside',
        panel.background = element_rect(fill = "white", colour = "black"),# white background in main panels
        strip.background = element_rect(fill = "white", colour = "black"), # white background in strips
        strip.text.x = element_text(size = 18),#16, color = "red", face = "bold.italic"
        strip.text.y = element_text(size = 18),#16
        plot.title = element_text(size=22),
        axis.title=element_text(size=22),#18
        axis.text.x=element_text(size=rel(2)),#1.7
        axis.text.y=element_text(size=rel(2)),#1.7
        legend.title=element_text(size=22),#18
        legend.text=element_text(size=20),#16
        legend.key = element_blank(),# removes grey background behind symbols in legend
        ) +
  geom_pointrange(aes(ymin = oc_ci_l*(-1), 
                      ymax = oc_ci_u*(-1)
                      ), 
                  position=position_dodge(width=0.3),
                  size = 0.9) + 
  geom_text(data = anno_oc, aes(x = x,  y = y, label = lab),
           colour = "grey",  size=6) +
  theme(legend.position="none")

fig4a
```
Figure shows: Mean annual opportunity costs of switching from BAU to MIT rotations (i.e., the chosen option is MIT; the foregone option is BAU), for current conditions and worst-case conditions. âCurrentâ opportunity costs are calculated as BAU, current density â MIT, current density. âWorst-case â opportunity costs are calculated as BAU, worst-case density â MIT, current density. âWorst-caseâ is defined as 100% of surveyed grid cells in a field having very high black-grass density. **Points below the line at y=0 indicate that MIT strategies did better than BAU strategies.** Error bars show 95% CIs, which indicate year-to-year variation within a rotation. x-axis abbreviations: D, density; R, resistance; L, low; H, high. Annotations show number of spring crops, âsâ, and winter wheat crops, âwâ, in the 6-year rotation.

## 4.3. Figure 4(b): Productivity costs

### 4.3.1.Specify plot annotations
These show **numbers of winter wheat crops** in each rotation.
```{r Fig4b-annotations}
anno_pc <- data.frame(
  x = c("HD-HR","HD-HR","HD-HR",
        "HD-HR","HD-HR","HD-HR",
        "HD-HR","HD-HR","HD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-LR","LD-LR","LD-LR",
        "LD-LR","LD-LR","LD-LR",
        "LD-LR","LD-LR","LD-LR"
        ),
  y = c(-6.2,-6.2,-6.2,
        -6.2,-6.2,-6.2,
        -6.2,-6.2,-6.2,
        -6.2,-6.2,-6.2,
        -6.2,-6.2,-6.2,
        -6.2,-6.2,-6.2,
        -6.2,-6.2,-6.2,
        -6.2,-6.2,-6.2,
        -6.2,-6.2,-6.2
        ),
  # numbers of winter wheat crops:
  lab = c("2", "2", "2", # north, HD-HR
          "2", "2", "2", # central, HD-HR
          "2", "2", "2", # east, HD-HR
          
          "2", "2", "2", # north, LD-HR
          "2", "2", "2", # central, LD-HR
          "3", "3", "3", # east, LD-HR
          
          "3", "3", "3", # north, LD-LR
          "3", "3", "3", # central, LD-LR
          "4", "4", "4"  # east, LD-LR
          ),
  region = c("north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east",
             "north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east",
             "north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east"
             ),
  soiltype = c("heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light"
               ),
  situation = c("Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current",
                "Current", "Current", "Current"
                )
           ) %>% 
  dplyr::mutate(
    region = factor(region,
                    levels = c("north", "central", "east")
                    ),
    soiltype = factor(soiltype,
                    levels = c("heavy", "medium", "light")
                    )
  )
```

### 4.3.2. Specify plot 
```{r Fig4b-plot}
fig4b <- ggplot(df_wc_pc, aes(initdenres_collapsed, pc*(-1), 
                    colour = situation, shape = situation)) + 
  facet_grid(region ~ soiltype,
             labeller = labeller(region = region.labs, 
                                 soiltype = soiltype.labs)
  ) +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  geom_hline(aes(yintercept = 0), color="grey") + #, linetype="dashed"
  labs(x = "Initial density and resistance", 
       y = "Mean annual productivity cost, BAU-MIT (t/ha)") +
  # specify colours for 'situation':
  scale_color_manual(name = "Situation",
                     values = c("grey61", # current
                                "#000000"  # worst case
                                )
                     ) + 
  scale_shape_manual(name = "Situation",
                     values=c(15, 16)) + # current 15 square; worst 16 circle
  theme(strip.placement = 'outside',
        #strip.background.x = element_blank(),
        #strip.text.x = element_blank(), # removes facet labels
        panel.background = element_rect(fill = "white", colour = "black"),# white background in main panels
        strip.background = element_rect(fill = "white", colour = "black"), # white background in strips
        strip.text.x = element_text(size = 18),#16, color = "red", face = "bold.italic"
        strip.text.y = element_text(size = 18),#16
        plot.title = element_text(size=22),
        axis.title=element_text(size=22),#18
        axis.text.x=element_text(size=rel(2)),#1.7
        axis.text.y=element_text(size=rel(2)),#1.7
        legend.title=element_text(size=22),#18
        legend.text=element_text(size=20),#16
        legend.key = element_blank(),# removes grey background behind symbols in legend
        #legend.title = element_blank()
        ) +
  geom_pointrange(aes(ymin = pc_ci_l*(-1), 
                      ymax = pc_ci_u*(-1)
                      ), 
                  position=position_dodge(width=0.3),
                  size = 0.9) + 
  geom_text(data = anno_pc, aes(x = x,  y = y, label = lab),
           colour = "grey",  size=6) 

fig4b
```
**Figure shows:** Mean annual productivity costs of switching from BAU to MIT rotations (i.e., the chosen option is MIT; the foregone option is BAU), for current conditions and worst-case conditions. Currentâ productivity costs are calculated as BAU, current density â MIT, current density. âWorst-caseâ productivity costs â in other words, is it better for wheat production to switch pre-emptively to MIT, or is it better for wheat production to continue with BAU in the knowledge that weed density will get worse â are calculated as BAU, worst-case density â MIT, current density. âWorst-caseâ is defined as 100% of surveyed grid cells in a field having very high black-grass density. **Points below the line at y=0 indicate that MIT strategies did better than BAU strategies.** Error bars show 95% CIs, which indicate year-to-year variation within a rotation. x-axis abbreviations: D, density; R, resistance; L, low; H, high. Annotations show numbers of winter wheat crops in the 6-year rotation.


## 4.4. Make panel plot
```{r Fig4-arrange-panels}
fig4 <- (fig4a + fig4b) + 
  plot_annotation(tag_levels = 'a', tag_prefix = '(',  tag_suffix = ')') & 
  theme(plot.tag = element_text(size = 24, face="bold"))
fig4
```

## 4.5. Save plot
```{r}
png("../figures/Figure 4.png",
    height = 10, width = 20, units = "in", res = 300)
print(fig4)
dev.off()
```

# 5. Figure 5: When does it flip?
See script 4e.

# ----
# SUPPLEMENTARY FIGURES ----
# 6. Figure S4: Scatter plot, density - LD-HR with init HD
Scatter plot of final density (density at year 6) by 3 initial conditions, for BAU and MIT scenarios. Use the `prophvh_3dr` data set: this contains the mean proportion of quadrats in high or very high density states, with initial density-resistance states collapsed to three levels.

## 6.1. Specify panel labels
Specify what you want written in the facet strips.
```{r FigS4-panel-labels}
region.labs <- c("Northern England", "Central England", "Eastern England") # new
names(region.labs) <- c("north", "central", "east") # original

soiltype.labs <- c("Heavy soil", "Medium soil", "Light soil") # new
names(soiltype.labs) <- c("heavy", "medium", "light") # original
```

## 6.2. Specify plot annotations
These will show the **numbers of spring crops** in each rotation.
```{r FigS4-annotations}
anno_FigS4 <- data.frame(
  x = c("HD-HR","HD-HR","HD-HR",
        "HD-HR","HD-HR","HD-HR",
        "HD-HR","HD-HR","HD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-LR","LD-LR","LD-LR",
        "LD-LR","LD-LR","LD-LR",
        "LD-LR","LD-LR","LD-LR"
        ),
  y = c(-0.1,-0.1,-0.1,
        -0.1,-0.1,-0.1,
        -0.1,-0.1,-0.1,
        -0.1,-0.1,-0.1,
        -0.1,-0.1,-0.1,
        -0.1,-0.1,-0.1,
        -0.1,-0.1,-0.1,
        -0.1,-0.1,-0.1,
        -0.1,-0.1,-0.1
        ),
  # numbers of spring crops:
  lab = c("3", "3", "3", # north, HD-HR
          "3", "3", "3", # central, HD-HR
          "4", "4", "4", # east, HD-HR
          
          "2", "2", "2", # north, LD-HR
          "2", "2", "2", # central, LD-HR
          "1", "1", "1", # east, LD-HR
          
          "1", "1", "1", # north, LD-LR
          "1", "1", "1", # central, LD-LR
          "0", "0", "0"  # east, LD-LR
          ),
  region = c("north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east",
             "north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east",
             "north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east"
             ),
  soiltype = c("heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light"
               ),
  scenario = c("MIT", "MIT", "MIT",
               "MIT", "MIT", "MIT",
               "MIT", "MIT", "MIT",
               "MIT", "MIT", "MIT",
               "MIT", "MIT", "MIT",
               "MIT", "MIT", "MIT",
               "MIT", "MIT", "MIT",
               "MIT", "MIT", "MIT",
               "MIT", "MIT", "MIT"
                )
           ) %>% 
  dplyr::mutate(
    region = factor(region,
                    levels = c("north", "central", "east")
                    ),
    soiltype = factor(soiltype,
                    levels = c("heavy", "medium", "light")
                    )
  )
```

## 6.3. Specify plot
For fields with high initial density, I want to see whether black-grass density is reduced by the LD-HR strategies. In these fields, the HD-HR strategies did successfully reduce BG density, but would LD-HR strategies also be successful? Add red points to show the LD-HR scenario run with initial high density.
```{r FigS4-plot}
figS4 <- ggplot(density_3dr %>% dplyr::filter(year == 6 & !scenario=="CWW"), #Keep only yr 6, remove CWW
       aes(initDR3, hvh_mean, colour = scenario, shape = scenario)) + 
  facet_grid(region ~ soiltype, labeller = labeller(region = region.labs, 
                                                    soiltype = soiltype.labs)) +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  ylim(-0.15, 1) +
  labs(x = "Initial density and resistance of Black-grass population", 
       y = "Proportion of field with economically- \ndamaging Black-grass density at year 6") +
  # specify colours and shapes for 'scenario':
  scale_color_manual(name = "Scenario",
                     values = c("#00306F", # BAU, madison blue
                                "#00C2F9")) + # MIT, capri blue
  scale_shape_manual(name = "Scenario",
                     values=c(15, 16)) + # BAU 15 = square; MIT 16 = circle
  theme(strip.placement = 'outside',
        strip.text.x = element_text(size = 16),#, color = "red", face = "bold.italic"
        strip.text.y = element_text(size = 16),
        plot.title = element_text(size=22),
        axis.title=element_text(size=18),
        axis.text.x=element_text(size=rel(1.7)),
        axis.text.y=element_text(size=rel(1.7)),
        legend.title=element_text(size=18),
        legend.text=element_text(size=16)
  ) +
  geom_pointrange(aes(ymin = hvh_ci_l, 
                      ymax = hvh_ci_u),
                  size = 0.9) + 
  geom_text(data = anno_FigS4, aes(x = x,  y = y, label = lab),
           colour = "gray48", size=7)  +
  # add new point:
  # re-define data and overwrite top layer inheritance
  geom_pointrange(data = density_3dr_hd %>% 
                  dplyr::filter(year == 6 & initDR3=="LD-HR" & scenario=="MIT") %>% 
                  dplyr::mutate(
                    initDR3 = recode_factor(initDR3, "LD-HR" = "HD-HR")),
                  aes(ymin = hvh_ci_l, 
                      ymax = hvh_ci_u),
                  color = "red",
                  size = 0.9,
                  show.legend = FALSE)

figS4
```

## 6.4. Save plot
```{r FigS4-save}
png("../figures/Supplementary Figure S4.png",
    height = 10, width = 10, units = "in", res = 300)
print(figS4)
dev.off()
```

# 7. Figure S5: Scatter plots, gp and wheat yield
## 7.1. Specify panel labels  
```{r panel-labels-region-and-soiltype}
region.labs <- c("Northern England", "Central England", "Eastern England") # new
names(region.labs) <- c("north", "central", "east") # original

soiltype.labs <- c("Heavy soil", "Medium soil", "Light soil") # new
names(soiltype.labs) <- c("heavy", "medium", "light") # original
```

## 7.2. Figure S5(a): Gross profit scatter plot
### 7.2.1. Specify plot annotations
These will show the **numbers of spring crops** in each rotation.
```{r Fig-S5a-annotations}
anno_gp <- data.frame(
  x = c("HD-HR","HD-HR","HD-HR",
        "HD-HR","HD-HR","HD-HR",
        "HD-HR","HD-HR","HD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-LR","LD-LR","LD-LR",
        "LD-LR","LD-LR","LD-LR",
        "LD-LR","LD-LR","LD-LR"
        ),
  y = c(150,150,150,
        150,150,150,
        150,150,150,
        150,150,150,
        150,150,150,
        150,150,150,
        150,150,150,
        150,150,150,
        150,150,150
        ),
  # numbers of spring crops:
  lab = c("3", "3", "3", # north, HD-HR
          "3", "3", "3", # central, HD-HR
          "4", "4", "4", # east, HD-HR
          
          "2", "2", "2", # north, LD-HR
          "2", "2", "2", # central, LD-HR
          "1", "1", "1", # east, LD-HR
          
          "1", "1", "1", # north, LD-LR
          "1", "1", "1", # central, LD-LR
          "0", "0", "0"  # east, LD-LR
          ),
  region = c("north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east",
             "north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east",
             "north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east"
             ),
  soiltype = c("heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light"
               ),
  scenario = c("MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT"
                )
           ) %>% 
  dplyr::mutate(
    region = factor(region,
                    levels = c("north", "central", "east")
                    ),
    soiltype = factor(soiltype,
                    levels = c("heavy", "medium", "light")
                    )
  )
```

### 7.2.2. Specify plot of gross profit
```{r Fig-S5a-plot}
plot_scatter_gp <- ggplot(df_scatter_gp %>% 
         filter(!scenario=="CWW"),
       aes(initdenres_collapsed, gp, 
                   colour = scenario, 
                   shape = scenario)) + 
  #geom_point(size = 4) +
  facet_grid(region ~ soiltype,
             labeller = labeller(region = region.labs, 
                                 soiltype = soiltype.labs)
  ) +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  labs(x = "Initial density and resistance of Black-grass population", 
       y = "Mean annual gross profit (Â£/ha)") +
  # specify colours for 'scenario':
  scale_color_manual(name = "Scenario",
                     values = c("#00306F", # BAU, madison blue
                                "#00C2F9"  # MIT, capri blue
                                )
                     )+ 
  scale_shape_manual(name = "Scenario",
                     values=c(15, 16)) + # BAU, 15 = square; MIT, 16 = circle
  theme(strip.placement = 'outside',
        strip.text.x = element_text(size = 16),
        strip.text.y = element_text(size = 16),
        plot.title = element_text(size=22),
        axis.title=element_text(size=18),
        axis.text.x=element_text(size=rel(1.7)),
        axis.text.y=element_text(size=rel(1.7)),
        legend.title=element_text(size=18),
        legend.text=element_text(size=16)
        ) +
  geom_pointrange(aes(ymin = gp_ci_l, 
                      ymax = gp_ci_u
                      ), 
                  position=position_dodge(width=0.3),
                  size = 0.9) +
  theme(legend.position="none") +
  geom_pointrange(data = df_scatter_gp_hd %>% 
                  dplyr::filter(initdenres_collapsed=="LD-HR" & scenario=="MIT") %>% 
                  dplyr::mutate(
                    initdenres_collapsed = recode_factor(initdenres_collapsed, 
                                                         "LD-HR" = "HD-HR")),
                  aes(ymin = gp_ci_l, 
                      ymax = gp_ci_u),
                  color = "red",
                  #position=position_dodge(width=0.3),
                  size = 0.9,
                  show.legend = FALSE) + 
  geom_text(data = anno_gp, aes(x = x,  y = y, label = lab),
           colour = "grey",  size=6) 

plot_scatter_gp
```

95% CIs show year-to-year variation.  

## 7.3. Figure S5(b): Wheat yield scatter plot
### 7.3.1. Specify plot annotations
Specify annotations. These show **numbers of winter wheat crops** in each rotation.
```{r Fig-S5b-annotations}
anno_ww <- data.frame(
  x = c("HD-HR","HD-HR","HD-HR",
        "HD-HR","HD-HR","HD-HR",
        "HD-HR","HD-HR","HD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-HR","LD-HR","LD-HR",
        "LD-LR","LD-LR","LD-LR",
        "LD-LR","LD-LR","LD-LR",
        "LD-LR","LD-LR","LD-LR"
        ),
  y = c(-0.5,-0.5,-0.5,
        -0.5,-0.5,-0.5,
        -0.5,-0.5,-0.5,
        -0.5,-0.5,-0.5,
        -0.5,-0.5,-0.5,
        -0.5,-0.5,-0.5,
        -0.5,-0.5,-0.5,
        -0.5,-0.5,-0.5,
        -0.5,-0.5,-0.5
        ),
  # numbers of winter wheat crops:
  lab = c("2", "2", "2", # north, HD-HR
          "2", "2", "2", # central, HD-HR
          "2", "2", "2", # east, HD-HR
          
          "2", "2", "2", # north, LD-HR
          "2", "2", "2", # central, LD-HR
          "3", "3", "3", # east, LD-HR
          
          "3", "3", "3", # north, LD-LR
          "3", "3", "3", # central, LD-LR
          "4", "4", "4"  # east, LD-LR
          ),
  region = c("north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east",
             "north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east",
             "north",   "north",   "north", 
             "central", "central", "central",
             "east",    "east",    "east"
             ),
  soiltype = c("heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light",
               "heavy", "medium", "light"
               ),
  scenario = c("MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT",
                "MIT", "MIT", "MIT"
                )
           ) %>% 
  dplyr::mutate(
    region = factor(region,
                    levels = c("north", "central", "east")
                    ),
    soiltype = factor(soiltype,
                    levels = c("heavy", "medium", "light")
                    )
  )
```

### 7.3.2. Specify plot of winter wheat yield
```{r Fig-S5b-plot}
plot_scatter_wwyld <- ggplot(df_scatter_wwyld %>% 
         filter(!scenario=="CWW"),
       aes(initdenres_collapsed, ww_mean, 
                   colour = scenario, 
                   shape = scenario)) + 
  #geom_point(size = 4) +
  facet_grid(region ~ soiltype,
             labeller = labeller(region = region.labs, 
                                 soiltype = soiltype.labs)
  ) +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  labs(x = "Initial density and resistance of Black-grass population", 
       y = "Mean annual wheat yield (Â£/ha)") +
  # specify colours for 'scenario':
  scale_color_manual(name = "Scenario",
                     values = c("#00306F", # BAU, madison blue
                                "#00C2F9"  # MIT, capri blue
                                )
                     )+ 
  scale_shape_manual(name = "Scenario",
                     values=c(15, 16)) + # BAU, 15 = square; MIT, 16 = circle
  theme(strip.placement = 'outside',
        strip.text.x = element_text(size = 16),#, color = "red", face = "bold.italic"
        strip.text.y = element_text(size = 16),
        plot.title = element_text(size=22),
        axis.title=element_text(size=18),
        axis.text.x=element_text(size=rel(1.7)),#, 
        axis.text.y=element_text(size=rel(1.7)),
        legend.title=element_text(size=18),
        legend.text=element_text(size=16)
        ) +
  geom_pointrange(aes(ymin = ww_ci_l,# 
                      ymax = ww_ci_u
                      ), 
                  position=position_dodge(width=0.3),
                  size = 0.9) +
  geom_pointrange(data = df_scatter_wwyld_hd %>% 
                  dplyr::filter(initdenres_collapsed=="LD-HR" & scenario=="MIT") %>% 
                  dplyr::mutate(
                    initdenres_collapsed = recode_factor(initdenres_collapsed, 
                                                         "LD-HR" = "HD-HR")),
                  aes(ymin = ww_ci_l, 
                      ymax = ww_ci_u),
                  color = "red",
                  #position=position_dodge(width=0.3),
                  size = 0.9,
                  show.legend = FALSE) + 
  geom_text(data = anno_ww, aes(x = x,  y = y, label = lab),
           colour = "grey",  size=6) 

plot_scatter_wwyld
```

## 7.4. Arrange as panel plot
```{r Fig-S5-arrange-panels}
figS5 <- (plot_scatter_gp + plot_scatter_wwyld) + 
  plot_annotation(tag_levels = 'a', tag_prefix = '(',  tag_suffix = ')') & 
  theme(plot.tag = element_text(size = 24, face="bold"))
figS5
```

## 7.5. Save plot
```{r FigS5-save}
png("../figures/Supplementary Figure S5.png",
    height = 10, width = 20, units = "in", res = 300)
print(figS5)
dev.off()
```

# 8. Figure S6: Sensitivity analysis plots

## 8.1. Figure S6(a): Scatter plot, gp, MIT & BAU
### 8.1.1. Specify panel labels  
```{r FigS6-panel-labels}
region.labs <- c("Northern England", "Central England", "Eastern England") # new
names(region.labs) <- c("north", "central", "east") # original

soiltype.labs <- c("Heavy soil", "Medium soil", "Light soil") # new
names(soiltype.labs) <- c("heavy", "medium", "light") # original
```

### 8.1.2. Specify plot
Plot results of sensitivity analysis for gross profit, BAU and MIT scenarios.
```{r FigS6a-plot}
figS6a <- ggplot(gp_oc %>% filter(!scenario=="CWW"), 
                aes(initdenres_collapsed, gp, 
                    colour = ID, shape = ID)) + 
  facet_grid(region ~ soiltype,
             labeller = labeller(region = region.labs, 
                                 soiltype = soiltype.labs)
  ) +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  labs(x = "Initial density and resistance", 
       y = "Mean annual gross profit (Â£/ha)") +
  # specify colours for 'scenario':
  scale_color_manual(name = "Scenario & 
yield penalties",
                     values = c("#88CCEE", # BAU, lower yield penalty
                                "#005FCC", # BAU
                                "#00306F", # BAU, upper yield penalty
                                
                                "#DDCC77", # MIT, lower yield penalty
                                "#999933", # MIT
                                "#117733" # MIT, upper yield penalty
                                )) + 
  scale_shape_manual(name = "Scenario & 
yield penalties",
                     values=c(15, 15, 15,    # BAU 15 = square
                              16, 16, 16)) + # MIT 16 = circle
  theme(strip.placement = 'outside',
        strip.text.x = element_text(size = 18),
        strip.text.y = element_text(size = 18),
        axis.title=element_text(size=22),
        axis.text.x=element_text(size=rel(1.9)),
        axis.text.y=element_text(size=rel(1.9)),
        legend.title=element_text(size=20),
        legend.text=element_text(size=18)
        ) +
  geom_pointrange(aes(ymin = gp_ci_l, 
                      ymax = gp_ci_u), 
                  position=position_dodge(width=0.6),
                  size = 0.9) 

figS6a
```


## 8.2. Figure S6(a): Scatter plot, ww, MIT & BAU
If not done above, specify the labels for the panels.  
```{r specify-panel-labels-SA-ww}
region.labs <- c("Northern England", "Central England", "Eastern England") # new
names(region.labs) <- c("north", "central", "east") # original

soiltype.labs <- c("Heavy soil", "Medium soil", "Light soil") # new
names(soiltype.labs) <- c("heavy", "medium", "light") # original
```

Then specify the plot.
```{r plot-ww-sensanaly-noCWW}
scatt_SA_ww <- ggplot(ww_pc %>% filter(!scenario=="CWW"), 
                aes(initdenres_collapsed, ww, 
                    colour = ID, shape = ID)) + 
  facet_grid(region ~ soiltype,
             labeller = labeller(region = region.labs, 
                                 soiltype = soiltype.labs)
  ) +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  labs(x = "Initial density and resistance", 
       y = "Mean annual wheat yield (t/ha)") +
  # specify colours for 'scenario':
  scale_color_manual(name = "Scenario & 
yield penalties",
                     values = c("#88CCEE", # BAU, lower yield penalty
                                "#005FCC", # BAU
                                "#00306F", # BAU, upper yield penalty
                                
                                "#DDCC77", # MIT, lower yield penalty
                                "#999933", # MIT
                                "#117733" # MIT, upper yield penalty
                                )) + 
  scale_shape_manual(name = "Scenario & 
yield penalties",
                     values=c(15, 15, 15,    # BAU 15 = square
                              16, 16, 16)) + # MIT 16 = circle
  theme(strip.placement = 'outside',
        strip.text.x = element_text(size = 18),
        strip.text.y = element_text(size = 18),
        axis.title=element_text(size=22),
        axis.text.x=element_text(size=rel(1.9)),
        axis.text.y=element_text(size=rel(1.9)),
        legend.title=element_text(size=20),
        legend.text=element_text(size=18)
        ) +
  geom_pointrange(aes(ymin = ww_ci_l, 
                      ymax = ww_ci_u), 
                  position=position_dodge(width=0.6),
                  size = 0.9) 

scatt_SA_ww
```



Save plot.
```{r save-SA-ww-plot-noCWW}
png("../figures/Script 10_SA_ww by initcondit_BAU & MIT.png",
    height = 10, width = 10, units = "in", res = 300)
print(scatt_SA_ww)
dev.off()
```
